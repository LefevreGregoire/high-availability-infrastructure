# Installation et Configuration des serveurs Backend

Cette partie du TP concerne la mise en place de deux serveurs backend avec une architecture résiliente basée sur Keepalived pour la gestion de l'IP virtuelle (VIP).

Architecture

    BACKEND01 : Serveur backend principal (192.168.1.250)
    BACKEND02 : Serveur backend secondaire (192.168.1.251)
    VIP Backend : Adresse IP virtuelle partagée (192.168.1.200/24)

Prérequis

Les deux serveurs backend doivent avoir :

    Interface réseau : Réseau Interne
    Accès au réseau interne : 192.168.1.0/24
    Gateway : 192.168.1.252 (BACKEND01) ou 192.168.1.253 (BACKEND02)

#### Configuration réseau statique sur BACKEND01

Éditer le fichier /etc/network/interfaces :

```bash
sudo nano /etc/network/interfaces
```

Ajouter la configuration suivante :

```bash
# Interface réseau principale
auto enp0s3
iface enp0s3 inet static
    address 192.168.1.250
    netmask 255.255.255.0
    gateway 192.168.1.252
    dns-nameservers 8.8.8.8 8.8.4.4

#### Installation des serveurs Backend

Étape 1 : Installation des dépendances

Sur **BACKEND01** et **BACKEND02**, installer les paquets nécessaires :

```bash
# Mise à jour du système
sudo apt update && sudo apt upgrade -y

# Installation de PHP 8.2 et extensions requises
sudo apt install -y php8.2 php8.2-cli php8.2-common php8.2-curl php8.2-mbstring \
                     php8.2-xml php8.2-zip php8.2-intl git curl unzip

# Installation de Composer
curl -sS https://getcomposer.org/installer | php
sudo mv composer.phar /usr/local/bin/composer
sudo chmod +x /usr/local/bin/composer

# Vérification de l'installation
php --version
composer --version
```

Étape 2 : Clonage et configuration du projet

Sur les deux serveurs :

```bash

# Se positionner dans le répertoire approprié
cd /opt

# Cloner le dépôt GitHub
sudo git clone https://github.com/ClemLcs/ManageVMBack.git
cd ManageVMBack

# Donner les permissions appropriées
sudo chown -R www-data:www-data /opt/ManageVMBack
sudo chmod -R 755 /opt/ManageVMBack
```

Étape 3 : Installation des dépendances PHP
```bash
cd /opt/ManageVMBack

# Installation des dépendances avec Composer
sudo -u www-data composer install --no-dev --optimize-autoloader

# Vider le cache Symfony
sudo -u www-data php bin/console cache:clear
